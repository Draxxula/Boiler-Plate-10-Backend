<div class="sm bg-light mb-4 rounded">
  <h2>Edit Employee</h2>
</div>

<div class="card-body" *ngIf="!loading">
  <form [formGroup]="employeeForm" (ngSubmit)="onSubmit()">

    <!-- Employee ID -->
    <div class="mb-3">
      <label class="form-label">Employee ID</label>
      <input type="text" formControlName="employeeId" class="form-control" readonly>
    </div>

    <!-- Account -->
    <div class="mb-3">
        <label class="form-label">Account</label>
        <select formControlName="accountId" class="form-select" (change)="onAccountChange($event)">
            <option value="" disabled>Select Account</option>
            <option *ngFor="let acc of accounts" [value]="acc.id">
                {{ acc.email }} ({{ acc.firstName }} {{ acc.lastName }})
            </option>
        </select>
    </div>

    <!-- Position -->
    <div class="mb-3">
        <label class="form-label">Position</label>
        <input type="text" formControlName="position" class="form-control">
    </div>

    <!-- Department -->
    <div class="mb-3">
        <label class="form-label">Department</label>
        <select formControlName="departmentId" class="form-select">
            <option value="" disabled>Select Department</option>
            <option *ngFor="let dept of departments" [value]="dept.id">
            {{ dept.name }}
            </option>
        </select>
    </div>

    <!-- Hire Date -->
    <div class="mb-3">
      <label class="form-label">Hire Date</label>
      <input type="date" formControlName="hireDate" class="form-control" [max]="currentYearEnd">
    </div>

    <!-- Status -->
    <div class="mb-3">
        <label class="form-label">Status</label>
        <select formControlName="status" class="form-select">
            <option value="" disabled>Select Status</option>
            <option *ngFor="let s of statuses" [value]="s">{{ s }}</option>
        </select>
    </div>

    <div class="d-flex justify-content-end">
        <button type="submit" class="btn btn-primary me-2" [disabled]="submitting || employeeForm.invalid">Update</button>
        <a routerLink="/admin/employees" class="btn btn-secondary">Cancel</a>
    </div>
  </form>
</div>

<div *ngIf="loading" class="text-center m-5">
  <span class="spinner-border spinner-border-lg align-center"></span>
</div>
